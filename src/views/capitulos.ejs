<%- include('partials/header', { title: 'Capítulos' }) %>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Montserrat:wght@300;400;500;600;700;900&display=swap');

        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1919 50%, #0a0a0a 100%);
            background-attachment: fixed;
        }

        .font-headings {
            font-family: 'Bebas Neue', cursive;
            letter-spacing: 0.1em;
        }

        .neon-text {
            text-shadow: 0 0 10px #00f5d4, 0 0 20px #00f5d4, 0 0 30px #00f5d4;
        }

        .capitulo-card {
            transition: all 0.3s ease;
            background: rgba(26, 25, 25, 0.8);
            backdrop-filter: blur(10px);
        }

        .capitulo-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 245, 212, 0.3);
        }

        .capitulo-image {
            height: 250px;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .capitulo-card:hover .capitulo-image {
            transform: scale(1.05);
        }

        .stats-badge {
            background: rgba(242, 208, 13, 0.1);
            border: 1px solid #f2d00d;
        }
    </style>

    <!-- Hero Section -->
    <section class="pt-24 pb-16 bg-gradient-to-b from-lamaBlack to-lamaDark">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-5xl md:text-7xl font-headings text-lamaGold neon-text mb-6">
                NUESTROS CAPÍTULOS
            </h2>
            <p class="text-xl text-lamaBone max-w-3xl mx-auto mb-8">
                La familia L.A.M.A. se extiende por toda la Región Norte de Colombia,
                uniendo motociclistas apasionados en <%= stats.total_capitulos %> capítulos oficiales
            </p>

            <!-- Estadísticas Globales -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 max-w-4xl mx-auto">
                <div class="stats-badge rounded-lg p-6">
                    <div class="text-4xl font-headings text-lamaGold">
                        <%= stats.total_capitulos %>
                    </div>
                    <div class="text-sm text-lamaNeon uppercase">Capítulos</div>
                </div>
                <div class="stats-badge rounded-lg p-6">
                    <div class="text-4xl font-headings text-lamaGold">
                        <%= stats.total_miembros %>
                    </div>
                    <div class="text-sm text-lamaNeon uppercase">Miembros</div>
                </div>
                <div class="stats-badge rounded-lg p-6">
                    <div class="text-4xl font-headings text-lamaGold">
                        <%= stats.promedio_miembros %>
                    </div>
                    <div class="text-sm text-lamaNeon uppercase">Promedio/Cap.</div>
                </div>
                <div class="stats-badge rounded-lg p-6">
                    <div class="text-4xl font-headings text-lamaGold">2013</div>
                    <div class="text-sm text-lamaNeon uppercase">Desde</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Grid de Capítulos -->
    <section class="py-16">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <% capitulos.forEach(capitulo=> { %>
                    <div
                        class="capitulo-card rounded-lg overflow-hidden border-2 border-lamaGold/30 hover:border-lamaNeon">
                        <!-- Imagen del capítulo -->
                        <div class="overflow-hidden bg-lamaDark">
                            <img src="<%= capitulo.imagen %>" alt="<%= capitulo.nombre %>" class="capitulo-image w-full"
                                onerror="this.src='/img/capitulos/default.jpg'">
                        </div>

                        <!-- Contenido de la tarjeta -->
                        <div class="p-6">
                            <!-- Encabezado -->
                            <div class="mb-4">
                                <h3 class="text-2xl font-headings text-lamaGold mb-1">
                                    <%= capitulo.nombre %>
                                </h3>
                                <p class="text-sm text-lamaNeon">
                                    <svg class="w-4 h-4 inline mr-1" fill="currentColor" viewBox="0 0 24 24">
                                        <path
                                            d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" />
                                    </svg>
                                    <%= capitulo.departamento %>
                                </p>
                            </div>

                            <!-- Estadísticas del capítulo -->
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div class="bg-lamaBlack/50 rounded p-3 text-center">
                                    <div class="text-2xl font-headings text-lamaNeon">
                                        <%= capitulo.miembros %>
                                    </div>
                                    <div class="text-xs text-gray-400 uppercase">Miembros</div>
                                </div>
                                <div class="bg-lamaBlack/50 rounded p-3 text-center">
                                    <div class="text-2xl font-headings text-lamaGold">
                                        <%= capitulo.fundado %>
                                    </div>
                                    <div class="text-xs text-gray-400 uppercase">Fundado</div>
                                </div>
                            </div>

                            <!-- Descripción -->
                            <p class="text-sm text-gray-300 leading-relaxed">
                                <%= capitulo.descripcion %>
                            </p>

                            <!-- Badge especial para el más grande -->
                            <% if (capitulo.id===stats.capitulo_mas_grande.id) { %>
                                <div class="mt-4 flex items-center gap-2 text-xs text-lamaGold">
                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                        <path
                                            d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
                                    </svg>
                                    <span class="font-bold">Capítulo más grande</span>
                                </div>
                                <% } %>

                                    <!-- Badge para el más nuevo -->
                                    <% if (capitulo.id===stats.capitulo_mas_nuevo.id) { %>
                                        <div class="mt-4 flex items-center gap-2 text-xs text-lamaNeon">
                                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                                <path
                                                    d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z" />
                                            </svg>
                                            <span class="font-bold">Capítulo más reciente</span>
                                        </div>
                                        <% } %>
                        </div>
                    </div>
                    <% }); %>
            </div>
        </div>
    </section>

    <!-- Sección de Departamentos -->
    <section class="py-16 bg-lamaDark/50">
        <div class="container mx-auto px-4">
            <h2 class="text-4xl font-headings text-center text-lamaGold mb-12">
                PRESENCIA POR DEPARTAMENTO
            </h2>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-5xl mx-auto">
                <% Object.keys(porDepartamento).forEach(departamento=> {
                    const caps = porDepartamento[departamento];
                    const totalMiembros = caps.reduce((sum, c) => sum + c.miembros, 0);
                    %>
                    <div class="bg-lamaBlack/80 border border-lamaGold/30 rounded-lg p-6">
                        <h3 class="text-xl font-headings text-lamaNeon mb-4">
                            <%= departamento %>
                        </h3>
                        <div class="space-y-2 mb-4">
                            <% caps.forEach(cap=> { %>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-300">
                                        <%= cap.nombre %>
                                    </span>
                                    <span class="text-lamaGold font-bold">
                                        <%= cap.miembros %> miembros
                                    </span>
                                </div>
                                <% }); %>
                        </div>
                        <div class="pt-4 border-t border-lamaGold/20">
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-400">Total departamento:</span>
                                <span class="text-xl font-headings text-lamaGold">
                                    <%= totalMiembros %>
                                </span>
                            </div>
                        </div>
                    </div>
                    <% }); %>
            </div>
        </div>
    </section>

    <!-- Call to Action -->
    <section class="py-20 bg-gradient-to-t from-lamaBlack to-lamaDark">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-4xl md:text-6xl font-headings text-lamaGold mb-6">
                ¿QUIERES SER PARTE?
            </h2>
            <p class="text-xl text-lamaBone mb-8 max-w-2xl mx-auto">
                Únete a uno de nuestros capítulos y forma parte de la familia L.A.M.A.
            </p>
            <a href="/contacto"
                class="inline-block px-8 py-4 bg-lamaGold text-lamaBlack font-bold text-lg rounded hover:bg-lamaNeon transition transform hover:scale-105">
                CONTACTAR
            </a>
        </div>
    </section>

    <%- include('partials/footer') %>
